<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Stylus Drag Trail</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      overscroll-behavior: none;
      background: white;
      touch-action: none; /* prevents panning/zooming */
      cursor: none;
    }

    #cursor-dot {
      position: fixed;
      width: 24px;
      height: 24px;
      background: orange;
      border-radius: 50%;
      pointer-events: none;
      z-index: 10;
      display: none;
    }

    canvas {
      position: fixed;
      top: 0;
      left: 0;
      z-index: 0;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <canvas id="trail-canvas"></canvas>
  <div id="cursor-dot"></div>

  <script>
    const dot = document.getElementById("cursor-dot");
    const canvas = document.getElementById("trail-canvas");
    const ctx = canvas.getContext("2d");

    function resizeCanvas() {
      const vv = window.visualViewport;
      canvas.width = vv.width;
      canvas.height = vv.height;
    }

    resizeCanvas();
    window.visualViewport.addEventListener("resize", resizeCanvas);
    window.visualViewport.addEventListener("scroll", resizeCanvas);

    let mouse = { x: 0, y: 0 };
    let trail = [];
    let dragging = false;

    function updatePosition(clientX, clientY) {
      const offsetX = window.visualViewport.offsetLeft;
      const offsetY = window.visualViewport.offsetTop;
      const x = clientX - offsetX;
      const y = clientY - offsetY;
      mouse.x = x;
      mouse.y = y;
      if (dragging) {
        dot.style.transform = `translate(${x - 12}px, ${y - 12}px)`;
      }
    }

    document.addEventListener("pointerdown", (e) => {
      if (!e.isPrimary) return;
      dragging = true;
      dot.style.display = "block";
      updatePosition(e.clientX, e.clientY);
    });

    document.addEventListener("pointerup", (e) => {
      if (!e.isPrimary) return;
      dragging = false;
      dot.style.display = "none";
    });

    document.addEventListener("pointermove", (e) => {
      if (!e.isPrimary) return;
      updatePosition(e.clientX, e.clientY);
    });

    function animate() {
      requestAnimationFrame(animate);

      if (dragging) {
        trail.push({ x: mouse.x, y: mouse.y });
        if (trail.length > 15) trail.shift();
      }

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      if (dragging && trail.length > 1) {
        ctx.beginPath();
        for (let i = 0; i < trail.length; i++) {
          const point = trail[i];
          if (i === 0) ctx.moveTo(point.x, point.y);
          else ctx.lineTo(point.x, point.y);
        }
        ctx.strokeStyle = "orange";
        ctx.lineWidth = 18;
        ctx.lineCap = "round";
        ctx.stroke();
      }
    }

    animate();
  </script>
</body>
</html>
